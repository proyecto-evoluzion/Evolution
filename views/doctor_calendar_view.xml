<?xml version="1.0"?>
<odoo>

	<!-- Schedule Form -->
	<record id="clinica_doctor_schedule_form" model="ir.ui.view">
        <field name="name">doctor.schedule.form</field>
        <field name="model">doctor.schedule</field>
        <field name="arch" type="xml">
        <form string="Schedule Form">
        	<sheet>
        		<group name="main_group">
        			<group name="main_sub_group1" >
        				<field name='professional_id' required="1"/>
        				<field name='start_date' required="1"/>
        				<field name='duration' required="1"/>
        				<field name='end_date' required="1"/>
        			</group>
        			<group name="main_sub_group2" >
        			</group>
        		</group>
        		<notebook>
        			<page name="rooms" string="Waiting Rooms/Appointments">
        				 <field name="room_ids" colspan="4" nolabel="1" readonly="1">
        				 </field>
        			</page>
        		</notebook>
        	</sheet>
        </form>
    	</field>
    </record>
    
    <!-- Schedule Tree -->
    <record id="clinica_doctor_schedule_tree" model="ir.ui.view">
        <field name="name">doctor.schedule.tree</field>
        <field name="model">doctor.schedule</field>
        <field name="arch" type="xml">
            <tree string="Schedule Tree">
                <field name="professional_id"/>
        	    <field name='start_date'/>
   				<field name="end_date"/>
            </tree>
        </field>
    </record>
    
    <!-- schedule Calendar View -->
    <record id="view_doctor_schedule_calendar" model="ir.ui.view">
        <field name="name">doctor.schedule.calendar</field>
        <field name="model">doctor.schedule</field>
        <field name="arch" type="xml">
            <calendar color="professional_id" date_start="start_date" date_stop="end_date" string="Schedule">
                <field name="professional_id"/>
                <field name="start_date"/>
                <field name="end_date"/>
            </calendar>
        </field>
    </record>
    
    <!-- Schedule Action -->
    <record id="action_clinica_doctor_schedule" model="ir.actions.act_window">
        <field name="name">Schedule</field>
        <field name="res_model">doctor.schedule</field>
        <field name="view_type">form</field>
        <field name="view_mode">calendar,tree,form</field>
        <field name="view_id" ref="view_doctor_schedule_calendar"/>
    </record> 
    
    <!-- Waitin room form -->
    <record id="clinica_waiting_room_form" model="ir.ui.view">
         <field name="name">doctor.waiting.room.form</field>
         <field name="model">doctor.waiting.room</field>
         <field name="arch" type="xml">
         <form string="Waiting Room Form">
         	<header>
                <button name="action_confirm" string="Confirm Appointment" class="btn-primary" type="object" states='new'/>
                <button name="action_view_nurse_sheet" string="Create Nurse Sheet" 
                	class="btn-primary" type="object" attrs="{'invisible': ['|',('nurse_sheet_created','=',True),('state','!=','ordered')]}"/>
                <button name="action_create_so" string="Create Sales Order" 
                	class="btn-primary" type="object" states="confirmed"/>
            	<field name="state" widget="statusbar" statusbar_visible="new,confirmed,ordered"/>
            </header>
         	<sheet>
         		<div class="oe_button_box" name="button_box">
                    <button name="action_view_sale_order" type="object" class="oe_stat_button" icon="fa-pencil-square-o" 
                    	states="ordered" string="Quotation">
                    </button>
                    <button name="action_view_nurse_sheet" type="object" class="oe_stat_button" icon="fa-pencil-square-o" 
                    	attrs="{'invisible': [('nurse_sheet_created', '=', False)]}" string="Nurse Sheets">
                    </button>
                </div>
         		<div class="oe_title">
                    <h1>
                        <field name="name" readonly="1"/>
                    </h1>
                </div>
         		<group name="main_group">
         			<group name="main_sub_group1" >
         				<field name='schedule_id' attrs="{'readonly':[('state','!=','new')]}"/>
         				<field name='patient_id' required="1" attrs="{'readonly':[('state','!=','new')]}"/>
         				<field name='procedure_date' required="1" attrs="{'readonly':[('state','!=','new')]}"/>
         				<field name='procedure_end_date' required="1" attrs="{'readonly':[('state','!=','new')]}"/>
         			</group>
         			<group name="main_sub_group2" >
         				<field name='document_type' attrs="{'readonly':[('state','!=','new')]}"/>
         				<field name='numberid' 
         					attrs="{'invisible':[('document_type','in',['cc','ti'])],'readonly':[('state','!=','new')]}"/>
         				<field name='numberid_integer' string="Number ID" 
         					attrs="{'invisible':[('document_type','not in',['cc','ti'])],'readonly':[('state','!=','new')]}"/>
         			</group>
         		</group>
         		<group name="patient_info_group1">
         			<group name="patient_info_sub1" >
         				<field name='first_name'  attrs="{'readonly':[('state','!=','new')]}"/>
         				<field name='first_last_name' attrs="{'readonly':[('state','!=','new')]}"/>
         				<field name='second_name' attrs="{'readonly':[('state','!=','new')]}"/>
         				<field name='second_last_name' attrs="{'readonly':[('state','!=','new')]}"/>
         			</group>
         			<group name="patient_info_sub2" >
         				<field name='phone' attrs="{'readonly':[('state','!=','new')]}"/>
         				<field name='gender' attrs="{'readonly':[('state','!=','new')]}"/>
         				<field name='birth_date' attrs="{'readonly':[('state','!=','new')]}"/>
         				<label for="age" string="Age" attrs="{'readonly':[('state','!=','new')]}"/>
	       				<div>
	       					<div>
	       						<field name="age" required="1" nolabel="1" class="oe_inline" readonly="1"/>
	      						<field name="age_meassure_unit" nolabel="1" class="oe_inline" />
	       					</div>
	       				</div>
	       				<field name='nurse_sheet_created' invisible="1"/>
         			</group>
         		</group>
         		<group name="profession_details">
         			<group name="profession_details_sub1" >
         				<field name='surgeon_id' domain="[('profession_type','=','doctor')]" 
         					attrs="{'readonly':[('state','!=','new')]}"/>
         				<field name='programmer_id'  attrs="{'readonly':[('state','!=','new')]}"/>
         			</group>
         			<group name="profession_details_sub2" >
         				<field name='anesthesiologist_id' domain="[('profession_type','=','anesthesiologist')]"  
         					attrs="{'readonly':[('state','!=','new')]}"/>
         				<field name='anesthesia_type'  attrs="{'readonly':[('state','!=','new')]}"/>
         			</group>
         		</group>
         		<group name="procedure">
         			<field name='procedure'  attrs="{'readonly':[('state','!=','new')]}"/>
         		</group>
         		<group name="procedure">
         			<field name='notes' />
         		</group>
         		<notebook>
        			<page name="procedures" string="Health Procedures">
        				 <field name="procedure_ids" colspan="4" nolabel="1"  attrs="{'readonly':[('state','!=','new')]}"
        				 	context="{'default_surgeon_id':surgeon_id,'default_anesthesiologist_id':anesthesiologist_id}">
        				 	<tree editable="bottom">
        				 		<field name="product_id"/>
        				 		<field name="quantity"/>
        				 		<field name="surgeon_id" invisible="1"/>
        				 		<field name="anesthesiologist_id" invisible="1"/>
        				 	</tree>
        				 </field>
        			</page>
        		</notebook>
         	</sheet>
         </form>
         </field>
     </record>
     
    <!-- Waiting room tree -->
    <record id="clinica_waiting_room_tree" model="ir.ui.view">
        <field name="name">doctor.waiting.room.tree</field>
        <field name="model">doctor.waiting.room</field>
        <field name="arch" type="xml">
            <tree string="Waiting Room Tree">
                <field name="schedule_id"/>
        	    <field name='patient_id'/>
   				<field name="surgeon_id"/>
   				<field name="anesthesiologist_id"/>
   				<field name="procedure_date"/>
   				<field name="procedure_end_date"/>
            </tree>
        </field>
    </record>
    
    <!--  Waiting room View -->
    <record id="view_waiting_room_calendar" model="ir.ui.view">
        <field name="name">doctor.waiting.room</field>
        <field name="model">doctor.waiting.room</field>
        <field name="arch" type="xml">
            <calendar color="surgeon_id" date_start="procedure_date" date_stop="procedure_end_date" string="Waiting Room">
                <field name="surgeon_id"/>
                <field name="anesthesiologist_id"/>
                <field name="patient_id"/>
                <field name="procedure_date"/>
                <field name="procedure_end_date"/>
            </calendar>
        </field>
    </record>
        
   <record id="clinica_waiting_room_filter" model="ir.ui.view">
        <field name="name">doctor.waiting.room.search</field>
        <field name="model">doctor.waiting.room</field>
        <field name="arch" type="xml">
            <search string="Search Appointments">
                <field name="surgeon_id"  />
                <field name='anesthesiologist_id'/>
                <field name="patient_id" />
                <field name="schedule_id" />
                <group expand="0" string="Group By">
                	<filter string="Patient" name="groupby_patient_id" domain="[]" context="{'group_by':'patient_id'}"/>
                	<filter string="Surgeon" name="groupby_surgeon_id" domain="[]" context="{'group_by':'surgeon_id'}"/>
                	<filter string="Anesthesiologist" name="groupby_anesthesiologist_id" domain="[]" context="{'group_by':'anesthesiologist_id'}"/>
                </group>
            </search>
        </field>
   </record>
        
        
    <!-- Waiting room search -->
    <record id="action_clinica_waiting_room" model="ir.actions.act_window">
        <field name="name">Appointment</field>
        <field name="res_model">doctor.waiting.room</field>
        <field name="view_type">form</field>
        <field name="view_mode">calendar,tree,form</field>
        <field name="view_id" ref="view_waiting_room_calendar"/>
        <field name="search_view_id" ref="clinica_waiting_room_filter"/>
    </record> 
            
   <!-- Waitin room menu -->
   <menuitem id="menu_clinica_waiting_room"
       name="Waiting Room "
       parent="menu_doctor_process"
       action="clinica_doctor_data.action_clinica_waiting_room"
       sequence="3"/>
    
    
    <!-- Schedule menu -->
    <menuitem id="menu_clinica_doctor_schedule"
        name="Schedule"
        parent="menu_doctor_process"
        action="clinica_doctor_data.action_clinica_doctor_schedule"
        sequence="4"/>

</odoo>